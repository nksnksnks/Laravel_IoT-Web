<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>IoT-NKS</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto:wght@500;700&display=swap" rel="stylesheet"> 
    
    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <div class="container-fluid position-relative d-flex p-0">
        <!-- Spinner Start -->
        <div id="spinner" class="show bg-dark position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <!-- Spinner End -->


        <!-- Sidebar Start -->
        <div class="sidebar pe-4 pb-3">
            <nav class="navbar bg-secondary navbar-dark">
                <a href="index.html" class="navbar-brand mx-4 mb-3">
                    <h3 class="text-primary"><i class="fa fa-user-edit me-2"></i>IoT-NKS</h3>
                </a>
                <div class="navbar-nav w-100">
                    <a href="index.html" class="nav-item nav-link active"><i class="fa fa-tachometer-alt me-2"></i>Trang chủ</a>
                    <a href="info.html" class="nav-item nav-link"><i class="fa fa-th me-2"></i>Thông tin cá nhân</a>
                    <a href="history.html" class="nav-item nav-link"><i class="fa fa-keyboard me-2"></i>Lịch sử</a>
                </div>
            </nav>
        </div>
        <!-- Sidebar End -->


        <!-- Content Start -->
        <div class="content">
            <nav class="navbar navbar-expand bg-secondary navbar-dark sticky-top px-4 py-0">
                <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
                    <h2 class="text-primary mb-0"><i class="fa fa-user-edit"></i></h2>
                </a>
                <a href="#" class="sidebar-toggler flex-shrink-0">
                    <i class="fa fa-bars"></i>
                </a>
                <div class="navbar-nav align-items-center ms-auto">
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <img class="rounded-circle me-lg-2" src="img/user.jpg" alt="" style="width: 40px; height: 40px;">
                            <span class="d-none d-lg-inline-flex">SownNK</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end bg-secondary border-0 rounded-0 rounded-bottom m-0">
                            <a href="#" class="dropdown-item">Trang chủ</a>
                            <a href="#" class="dropdown-item">Thông tin cá nhân</a>
                            <a href="#" class="dropdown-item">Lịch sử</a>
                        </div>
                    </div>
                </div>
            </nav>
            <!-- Navbar End -->


            <!-- Sale & Revenue Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="row g-3">
                    <div class="col-sm-6 col-xl-4 fontsize" style="margin-top:70px;">
                        <div class="bg-secondary rounded d-flex align-items-center justify-content-between p5">
                            <i class="fa fa-chart-line fa-3x bi bi-thermometer-half" 
                            id="temperatureIcon"></i>
                            <p id="temperatureWarningHot" 
                                class=" mb-2 d-none blinking"><i class="bi bi-exclamation-triangle-fill"></i> Cảnh báo quá nóng!</p>
                            <p id="temperatureWarningCold" 
                                class=" mb-2 d-none blinking"><i class="bi bi-exclamation-triangle-fill"></i> Cảnh báo quá lạnh!</p>
                            <div id="temperatureContainer" class="ms-3">
                                <!-- thermometer -->
                                <p class="mb-2">Nhiệt độ</p>
                                <h6 id="temperature" class="mb-0 number" id="temperatureElement">25℃</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-4 fontsize" style="margin-top:70px;">
                        <div class="bg-secondary rounded d-flex align-items-center justify-content-between p5">
                            <i class="fa fa-chart-line fa-3x bi bi-droplet-half" 
                            id="dropletIcon"></i>
                            <p id="dropletWarning1" 
                                class="mb-2 d-none blinking"><i class="bi bi-exclamation-triangle-fill warning"></i> Cảnh báo độ ẩm cao!</p>
                            <p id="dropletWarning2" 
                                class="mb-2 d-none blinking"><i class="bi bi-exclamation-triangle-fill warning"></i> Cảnh báo độ ẩm thấp!</p>
                            <div id="dropletContainer" class="ms-3">
                                <!-- droplet -->
                                <p class="mb-2">Độ ẩm</p>
                                <h6 id="droplet" class="mb-0 number" id="dropletElement">60%</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xl-4 fontsize" style="margin-top:70px;">
                        <div class="bg-secondary rounded d-flex align-items-center justify-content-between p5">
                            <i class="fa fa-chart-line fa-3x bi bi-lightbulb" 
                            id="lightIcon"></i>
                            <p id="lightWarning1" 
                                class=" mb-2 d-none blinking"><i class="bi bi-exclamation-triangle-fill warning"></i> Cảnh báo độ sáng mạnh!</p>
                            <p id="lightWarning2" 
                                class=" mb-2 d-none blinking"><i class="bi bi-exclamation-triangle-fill warning"></i> Cảnh báo độ sáng thấp!</p>
                            <div id="lightContainer" class="ms-3">
                                <!-- thermometer -->
                                <p class="mb-2">Độ sáng</p>
                                <h6 id="light" class="mb-0 number2" id="lightElement">100 Lux</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Sale & Revenue End -->


            <!-- Sales Chart Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="row g-4">
                    <div class="col-sm-12 col-xl-8">
                        <div class="bg-secondary text-center rounded p52">
                            <canvas id="temperature-humidity-lightIntensity"></canvas>
                        </div>
                    </div>
                    <div class="col-sm-12 col-xl-4">
                        <div class="bg-secondary text-center rounded p51" style="margin-bottom:1.25rem;" id="bulbcontainer">
                            <div class="bulb-container">
                                <div class="light">
                                    <div class="wire"></div>
                                    <div class="bulb">
                                        <span></span>
                                        <span></span>
                                    </div>
                                </div>
                            </div>
                            <div class="onoff">
                                <input id="toggle1" class="toggle checkbox" type="checkbox" role="switch" name="toggle" value="on" aria-checked="true">
                                <audio src="Click - Sound Effect.mp4" id="audio" autostart="false"></audio>
                                <label for="toggle1" class="slot" style="width:50px;">
                                    <span class="slot__label">FF</span>
                                    <span class="slot__label">N </span>
                                </label>
                                <div class="curtain"></div>
                            </div>
                        </div>
                        <div class="bg-secondary text-center rounded p51 fanContainer">
                            <div class="fan">
                                <div class="base"></div>
                                <label for="btn" class="labell" id="fanContainer">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </label>
                                <div class="onoff on-off2">
                                    <input id="toggle2" class="toggle checkbox checkboxfan" type="checkbox">
                                    <audio src="Click - Sound Effect.mp4" id="audio2" autostart="false"></audio>
                                    <label for="toggle2" class="slot" style="width:50px;">
                                        <span class="slot__label">FF</span>
                                        <span class="slot__label">N</span>
                                    </label>
                                    <div class="curtain"></div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="bg-secondary text-center rounded p51 fanContainer">
                            <div class="fan">
                                <div class="base"></div>
                                <label for="btn" class="labell" id="fanContainer">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </label>
                                <div class="onoff on-off2">
                                    <input id="toggle2" class="toggle checkbox checkboxfan" type="checkbox">
                                    <audio src="Click - Sound Effect.mp4" id="audio2" autostart="false"></audio>
                                    <label for="toggle2" class="slot" style="width:50px;">
                                        <span class="slot__label">FF</span>
                                        <span class="slot__label">N</span>
                                    </label>
                                    <div class="curtain"></div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- JavaScript Libraries -->
    <script>
        let toggle1 = document.querySelector('#toggle1');
        let bulbcontainer = document.querySelector('#bulbcontainer');
        let audio = document.querySelector('#audio');
        toggle1.addEventListener('change', function() {
            if (toggle1.checked) {
                audio.play();
                bulbcontainer.classList.add('on');
            } else {
                audio.play();
                bulbcontainer.classList.remove('on');
            }
        });

    </script>
    <script>
        let toggle2 = document.querySelector('#toggle2');
        let fancontainer = document.querySelector('#fanContainer');
        let audio2 = document.querySelector('#audio2');
        toggle2.addEventListener('change', function() {
            if (toggle2.checked) {
                audio2.play();
                fanContainer.classList.add('on2');
            } else {
                audio2.play();
                fanContainer.classList.remove('on2');
            }
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/chart/chart.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
    <script>
        var ctx2 = $("#temperature-humidity-lightIntensity").get(0).getContext("2d");
        var myChart2 = new Chart(ctx2, {
            type: "line",
            data: {
                labels: ["0", "0", "0", "0", "0", "0", "0", "0", "0"],
                datasets: [{
                        label: "Nhiệt độ",
                        yAxisID: 'A',
                        data: [0, 0, 0, 0, 0, 0, 0, 0, 0],
                        backgroundColor: "rgba(235, 22, 22, .7)",
                        // 

                        fill: true,
                    },
                    {
                        label: "Độ ẩm",
                        yAxisID: 'A',
                        data: [0, 0, 0, 0, 0, 0, 0, 0, 0],
                        backgroundColor: "rgba(82, 193, 245, .6)",
                        // borderColor: "rgb(82, 193, 245)",
                        fill: true,
                    },
                    {
                        label: "Độ sáng",
                        yAxisID: 'B',
                        data: [0, 0, 0, 0, 0, 0, 0, 0, 0],
                        backgroundColor: "rgba(255, 250, 87, .5)",
                        // borderColor: "rgb(255, 250, 87)",
                        fill: true,
                    }
                ]
                },
                options: {
                    responsive: true,
                    scales: {
                    A: {
                        type: 'linear',
                        position: 'left',
                        ticks: { beginAtZero: true, color: 'rgb(89, 94, 121)' },
                        // Hide grid lines, otherwise you have separate grid lines for the 2 y axes
                        grid: { display: false }
                    },
                    B: {
                        type: 'linear',
                        position: 'right',
                        ticks: { beginAtZero: true, color: 'rgb(89, 94, 121)' },
                        grid: { display: false }
                    },
                    x: { ticks: { beginAtZero: true } }
                    }
                }
    });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    <!-- Temperature -->
    <script>
        function getRandomTemperature(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    
        function getIconForTemperature(temperature) {
            if (temperature < 10) {
                return "bi bi-thermometer";
            } else if (temperature >= 10 && temperature < 20) {
                return "bi bi-thermometer-low";
            } else if (temperature >= 20 && temperature < 35) {
                return "bi bi-thermometer-half";
            } else {
                return "bi bi-thermometer-high";
            }
        }
    
        function temperatureToColor(temperature) {
            if(temperature<=45 && temperature>30){
                const red = 255;
                const green = 255-((temperature-30)/15)*255;
                const blue = 0;
                return `rgb(${red}, ${green}, ${blue})`;
            }else if(temperature<=30 && temperature>15){
                const red = 0;
                const green = 255;
                const blue = 170+((temperature-15)/15)*185;
                return `rgb(${red}, ${green}, ${blue})`;
            }else{
                const red = 0;
                const green = (temperature/45)*200;
                const blue = 255;
                return `rgb(${red}, ${green}, ${blue})`;
            }
        }
        const temperatureData = [0, 0, 0, 0, 0, 0, 0, 0, 0];
        const timeUpdate = ["0", "0", "0", "0", "0", "0", "0", "0", "0"]; 
        function updateTemperature() {
            const temperatureElement = document.getElementById('temperature');
            const temperatureContainer = document.getElementById('temperatureContainer');
            const randomTemperature = getRandomTemperature(0, 45);
            const temperatureWarning = document.getElementById('temperatureWarning');
            const temperatureWarningHot = document.getElementById('temperatureWarningHot');
            const temperatureWarningCold = document.getElementById('temperatureWarningCold');
            const temperatureIcon = document.getElementById('temperatureIcon');
            temperatureElement.textContent = randomTemperature + '℃';
            const bgColor = temperatureToColor(randomTemperature);
            const textColor = temperatureToColor(randomTemperature);
            temperatureContainer.style.color = textColor;
            temperatureIcon.className = "fa fa-3x " + getIconForTemperature(randomTemperature);
            temperatureIcon.style.color = textColor;
            temperatureElement.style.color = textColor;
            temperatureWarningCold.style.color = textColor;
            temperatureWarningHot.style.color = textColor;
            temperatureWarningHot.classList.toggle('d-none', randomTemperature <= 35);
            temperatureWarningCold.classList.toggle('d-none', randomTemperature >= 10);

            function getCurrentTime() {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                
                return `${hours}:${minutes}:${seconds}`;
            }
            timeUpdate.shift();
            timeUpdate.push(getCurrentTime());
            myChart2.data.labels = timeUpdate;

            temperatureData.shift();
            temperatureData.push(randomTemperature);
            myChart2.data.datasets[0].data = temperatureData;

            myChart2.update();
            setTimeout(updateTemperature, 2000);
            
        }
    
        document.addEventListener('DOMContentLoaded', function () {
            updateTemperature();
        });
    </script>


    <!-- Droplet -->
    <script>
        function getRandomDroplet(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function getIconForDroplet(droplet) {
            if (droplet < 40) {
                return "bi bi-droplet";
            } else if (droplet >= 40 && droplet < 65) {
                return "bi bi-droplet-half";
            } else {
                return "bi bi-droplet-fill";
            }
        }
    
        function dropletToColor(droplet) {
            const red = 199-(droplet/100)*199;
            const green = 216-(droplet/100)*(216-76);
            const blue = 255;
            return `rgb(${red}, ${green}, ${blue})`;
        }
        const dropletData = [0, 0, 0, 0, 0, 0, 0, 0, 0];
        function updateDroplet() {
            const dropletElement = document.getElementById('droplet');
            const dropletContainer = document.getElementById('dropletContainer');
            const randomDroplet = getRandomDroplet(0, 100);
            const dropletWarning1 = document.getElementById('dropletWarning1');
            const dropletWarning2 = document.getElementById('dropletWarning2');
            const dropletIcon = document.getElementById('dropletIcon');
            dropletElement.textContent = randomDroplet + '%';
            const bgColor = dropletToColor(randomDroplet);
            const textColor = dropletToColor(randomDroplet);
            dropletContainer.style.color = textColor;
            dropletIcon.style.color = textColor;
            dropletWarning1.style.color = textColor;
            dropletWarning2.style.color = textColor;
            dropletIcon.className = "fa fa-3x " + getIconForDroplet(randomDroplet);
            dropletIcon.style.color = textColor;
            dropletElement.style.color = textColor;
            dropletWarning1.classList.toggle('d-none', randomDroplet <= 70);
            dropletWarning2.classList.toggle('d-none', randomDroplet >= 10);
            
            dropletData.shift();

            dropletData.push(randomDroplet);

            myChart2.data.datasets[1].data = dropletData;

            myChart2.update();
            setTimeout(updateDroplet, 2000);
            
        }
    
        document.addEventListener('DOMContentLoaded', function () {
            updateDroplet();
        });
    </script>


    <!-- Light -->
    <script>
        function getRandomLight(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    
        function getIconForLight(light) {
            if (light < 100) {
                return "bi bi-lightbulb";
            } else {
                return "bi bi-lightbulb-fill";
            }
        }
    
        function lightToColor(light) {
            if(light < 150){
                const red = (light/150)*255;
                const green = (light/150)*200;
                const blue = 0;
                return `rgb(${red}, ${green}, ${blue})`;
            }else{
                const red = 255;
                const green = 255;
                const blue = ((light-150)/350)*255;
                return `rgb(${red}, ${green}, ${blue})`;
            }
        }
        const lightData = [0, 0, 0, 0, 0, 0, 0, 0, 0];
        function updateLight() {
            const lightElement = document.getElementById('light');
            const lightContainer = document.getElementById('lightContainer');
            const randomLight = getRandomLight(0, 500);
            const lightWarning1 = document.getElementById('lightWarning1');
            const lightWarning2 = document.getElementById('lightWarning2');
            const lightIcon = document.getElementById('lightIcon');
            lightElement.textContent = randomLight + ' Lux';
            const bgColor = lightToColor(randomLight);
            const textColor = lightToColor(randomLight);
            lightContainer.style.color = textColor;
            lightIcon.style.color = textColor;
            lightWarning1.style.color = textColor;
            lightWarning2.style.color = textColor;
            lightIcon.className = "fa fa-3x " + getIconForLight(randomLight);
            lightIcon.style.color = textColor;
            lightElement.style.color = textColor;
            lightWarning1.classList.toggle('d-none', randomLight <= 350);
            lightWarning2.classList.toggle('d-none', randomLight >= 100);
            lightData.shift();

            lightData.push(randomLight);

            myChart2.data.datasets[2].data = lightData;

            myChart2.update();
            setTimeout(updateLight, 2000);
            
        }
    
        document.addEventListener('DOMContentLoaded', function () {
            updateLight();
        });
    </script>
    <script>
        // for accessibility only
        document.getElementById("toggle").addEventListener("change",function() {
        this.setAttribute("aria-checked",this.checked);
        });
    </script>
    
</body>

</html>